>>>markdown
# Deduping rows in a table using a SQL block

Partition by the things that make the row unique.  Grab the first one.
>>>malloy
sql: flights_deduped is {
  connection: "duckdb"
  select: """
    SELECT * from 'data/flights.parquet'
    qualify ROW_NUMBER() over (partition by dep_time, origin, destination, flight_num) = 1
  """
}

source: flights is from_sql(flights_deduped)
>>>malloy
run: flights -> {aggregate: flight_count is count()}